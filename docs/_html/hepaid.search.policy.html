
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>hepaid.search.policy package &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'hepaid.search.policy';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="hepaid.search.parallel package" href="hepaid.search.parallel.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="markdown.html">
                        b-CASTOR
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="notebooks.html">
                        Content with notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="markdown-notebooks.html">
                        Notebooks with MyST Markdown
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="modules.html">
                        hepaid
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="markdown.html">
                        b-CASTOR
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="notebooks.html">
                        Content with notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="markdown-notebooks.html">
                        Notebooks with MyST Markdown
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="modules.html">
                        hepaid
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="hepaid.html">hepaid package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hepaid.hep.html">hepaid.hep package</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="hepaid.search.html">hepaid.search package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hepaid.search.models.html">hepaid.search.models package</a></li>
<li class="toctree-l3"><a class="reference internal" href="hepaid.search.parallel.html">hepaid.search.parallel package</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">hepaid.search.policy package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="intro.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="modules.html" class="nav-link">hepaid</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="hepaid.search.html" class="nav-link">hepaid.search package</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">hepaid.searc...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="hepaid-search-policy-package">
<h1>hepaid.search.policy package<a class="headerlink" href="#hepaid-search-policy-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-hepaid.search.policy.base">
<span id="hepaid-search-policy-base-module"></span><h2>hepaid.search.policy.base module<a class="headerlink" href="#module-hepaid.search.policy.base" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="hepaid.search.policy.base.Policy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.base.</span></span><span class="sig-name descname"><span class="pre">Policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objective_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ObjectiveFunction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DictConfig</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.base.Policy" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Policy base class to be inherited by Policy search methods. Load hyperparameters
config from a file if a string path is provided. Initialize metrics and iteration counter.
Creates a general save path.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.base.Policy.objective_function">
<span class="sig-name descname"><span class="pre">objective_function</span></span><a class="headerlink" href="#hepaid.search.policy.base.Policy.objective_function" title="Link to this definition">#</a></dt>
<dd><p>The objective function to be optimized.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ObjectiveFunction</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.base.Policy.hp">
<span class="sig-name descname"><span class="pre">hp</span></span><a class="headerlink" href="#hepaid.search.policy.base.Policy.hp" title="Link to this definition">#</a></dt>
<dd><p>The hyperparameters for the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DictConfig</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.base.Policy.hp_name">
<span class="sig-name descname"><span class="pre">hp_name</span></span><a class="headerlink" href="#hepaid.search.policy.base.Policy.hp_name" title="Link to this definition">#</a></dt>
<dd><p>The name of the hyperparameters file. Default is <cite>hprms.yaml</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.base.Policy.metrics">
<span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#hepaid.search.policy.base.Policy.metrics" title="Link to this definition">#</a></dt>
<dd><p>An instance of the Metrics class to track performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Metrics</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.base.Policy.save_path">
<span class="sig-name descname"><span class="pre">save_path</span></span><a class="headerlink" href="#hepaid.search.policy.base.Policy.save_path" title="Link to this definition">#</a></dt>
<dd><p>Path to save the datasets and checkpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.base.Policy.iteration">
<span class="sig-name descname"><span class="pre">iteration</span></span><a class="headerlink" href="#hepaid.search.policy.base.Policy.iteration" title="Link to this definition">#</a></dt>
<dd><p>The current iteration counter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">__init__(self,</span> <span class="pre">objective_function</span></span></dt>
<dd><p>ObjectiveFunction, hyper_parameters: DictConfig | str) -&gt; None:
Initialize the Policy class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">save_checkpoint(self,</span> <span class="pre">iteration</span></span></dt>
<dd><p>int) -&gt; None:
Save the objective function checkpoint, metrics, and search hyperparameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hepaid.search.policy.base.Policy.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#hepaid.search.policy.base.Policy.load_checkpoint" title="Link to this definition">#</a></dt>
<dd><p>Load the objective function and metrics to continue the search or for data analysis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Link to this definition">#</a></dt>
<dd><p>Load the objective function and metrics to continue the search or for data analysis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hepaid.search.policy.base.Policy.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#hepaid.search.policy.base.Policy.save_checkpoint" title="Link to this definition">#</a></dt>
<dd><p>Save the objective function checkpoint, metrics, and search hyperparameters.
The name for search hyperparameters can be modified by changing the .hp_name
attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>iteration</strong> (<em>int</em>) – The current iteration number.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-hepaid.search.policy.bcastor">
<span id="hepaid-search-policy-bcastor-module"></span><h2>hepaid.search.policy.bcastor module<a class="headerlink" href="#module-hepaid.search.policy.bcastor" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.bCASTOR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.bcastor.</span></span><span class="sig-name descname"><span class="pre">bCASTOR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objective_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.bcastor.bCASTOR" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hepaid.search.policy.base.Policy" title="hepaid.search.policy.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a></p>
<p>bCASTOR [1] is a variant of the Constraint Active Search (CAS) algorithm.
CAS is an alternative approach to the multiobjective design problem, formulated
as an Active Search Problem. In CAS, objectives are treated as constraints with known
desired threshold values, and the goal is to find diverse samples that satisfy all
the thresholds. These thresholds define the satisfactory region in the input space,
denoted as S.</p>
<p>To measure diversity, CAS uses Expected Coverage Improvement (ECI), which places hyper-spheres
around input data samples and aggregates the volume covered by each data point.</p>
<p>ECI is optimized by the Tree-structured Parzen Estimator (TPE) algorithm.
The optimization history, referred to as trials, is sampled using a rank-sampling strategy,
where the rank is determined by the ECI value of each trial. This sampling strategy enables
batch sampling, enhancing the discovery rate of the S region. bCASTOR reinterprets the ratio
of the hyper-spheres as a measure of the desired filling of samples, aiming to accumulate as many
diverse samples as possible.</p>
<p>[1]: Bayesian Active Search on Parameter Space: a 95 GeV Spin-0 Resonance in the (B - L) SSM.
M. A. Diaz, G. Cerro, S. Dasmahapatra, S. Moretti. <a class="reference external" href="https://arxiv.org/abs/2404.18653">https://arxiv.org/abs/2404.18653</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>objective_function</strong> (<em>ObjectiveFunction</em>) – The ObjectiveFunction to perform the search.</p></li>
<li><p><strong>hyper_parameters</strong> (<em>DictConfig</em><em> | </em><em>str</em>) – Hyperparameters for the bCASTOR strategy.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.bCASTOR.delta_r">
<span class="sig-name descname"><span class="pre">delta_r</span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.bCASTOR.delta_r" title="Link to this definition">#</a></dt>
<dd><p>Rate of change of the resolution parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.bCASTOR.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.bCASTOR.model" title="Link to this definition">#</a></dt>
<dd><p>The model used in the bCASTOR algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.bCASTOR.likelihood">
<span class="sig-name descname"><span class="pre">likelihood</span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.bCASTOR.likelihood" title="Link to this definition">#</a></dt>
<dd><p>The likelihood function used in the bCASTOR algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.bCASTOR.eci">
<span class="sig-name descname"><span class="pre">eci</span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.bCASTOR.eci" title="Link to this definition">#</a></dt>
<dd><p>Expected Coverage Improvement instance used in the bCASTOR algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.bCASTOR.study">
<span class="sig-name descname"><span class="pre">study</span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.bCASTOR.study" title="Link to this definition">#</a></dt>
<dd><p>The Optuna study object containing the trials.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.bCASTOR.metrics">
<span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.bCASTOR.metrics" title="Link to this definition">#</a></dt>
<dd><p>Metrics instance to collect and log performance metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Metrics</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.bCASTOR.iteration">
<span class="sig-name descname"><span class="pre">iteration</span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.bCASTOR.iteration" title="Link to this definition">#</a></dt>
<dd><p>Current iteration number.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.bCASTOR.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.bcastor.bCASTOR.run" title="Link to this definition">#</a></dt>
<dd><p>Executes the bCASTOR search algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The trained model after the search.
likelihood: The likelihood associated with the model.
eci: The Expected Coverage Improvement instance used.
study: The study object containing the search results.
metrics: The metrics collected during the search.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>model</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.bcastor_step">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.bcastor.</span></span><span class="sig-name descname"><span class="pre">bcastor_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.bcastor.bcastor_step" title="Link to this definition">#</a></dt>
<dd><p>Perform a single step of the bCASTOR algorithm.</p>
<p>ECI is optimized by the Tree-structured Parzen Estimator (TPE) algorithm.
The optimization history, referred to as trials, is sampled using a rank-sampling strategy,
where the rank is determined by the ECI value of each trial. This sampling strategy enables
batch sampling, enhancing the discovery rate of the S region. bCASTOR reinterprets the ratio
of the hyper-spheres as a measure of the desired filling of samples, aiming to accumulate as many
diverse samples as possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hp</strong> (<em>DictConfig</em>) – Hyperparameters for the bCASTOR algorithm.</p></li>
<li><p><strong>space_config</strong> (<em>dict</em>) – Configuration of the input space.</p></li>
<li><p><strong>constraints</strong> (<em>list</em>) – List of constraints for the search.</p></li>
<li><p><strong>bounds</strong> (<em>list</em>) – Bounds for the search space.</p></li>
<li><p><strong>train_x</strong> (<em>torch.tensor</em>) – Training data inputs.</p></li>
<li><p><strong>train_y</strong> (<em>torch.tensor</em>) – Training data outputs.</p></li>
<li><p><strong>model</strong> (<em>Any</em>) – Surrogate model used in the bCASTOR algorithm.</p></li>
<li><p><strong>delta_r</strong> (<em>float</em>) – Rate of change of the resolution parameter.</p></li>
<li><p><strong>step</strong> (<em>int</em>) – Current iteration step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Expected Coverage Improvement instance.
study (optuna.study.Study): The optuna study object containing the search results.
X (np.ndarray): The next set of samples to evaluate.
trials (np.ndarray): The array of trial configurations.
values (np.ndarray): The ECI values associated with the trials.
cr (float): The current resolution parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>eci (Callable)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.create_optuna_objective">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.bcastor.</span></span><span class="sig-name descname"><span class="pre">create_optuna_objective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eci</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.create_optuna_objective" title="Link to this definition">#</a></dt>
<dd><p>Creates the optuna objective function needed for the optimization based on the space_config dictionary.
Assumes the search space is normalized to [0,1]^d.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trial</strong> (<em>optuna.trial.Trial</em>) – The trial object used by optuna to suggest values for the hyperparameters.</p></li>
<li><p><strong>space_config</strong> (<em>dict</em>) – Configuration of the input space, specifying the features to be optimized.</p></li>
<li><p><strong>eci</strong> (<em>Callable</em>) – The Expected Coverage Improvement function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the ECI function for the suggested trial.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.optuna_study_cmaes">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.bcastor.</span></span><span class="sig-name descname"><span class="pre">optuna_study_cmaes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objective</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.bcastor.optuna_study_cmaes" title="Link to this definition">#</a></dt>
<dd><p>Maximise objective with CMAES</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.optuna_study_nsgaii">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.bcastor.</span></span><span class="sig-name descname"><span class="pre">optuna_study_nsgaii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objective</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.bcastor.optuna_study_nsgaii" title="Link to this definition">#</a></dt>
<dd><p>Maximise objective with NSGAII</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.optuna_study_tpe">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.bcastor.</span></span><span class="sig-name descname"><span class="pre">optuna_study_tpe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Study</span></span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.optuna_study_tpe" title="Link to this definition">#</a></dt>
<dd><p>Maximizes the objective function using the Tree-structured Parzen Estimator (TPE) algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>objective</strong> (<em>Callable</em>) – The objective function to be optimized.</p></li>
<li><p><strong>n_trials</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of trials to run the optimization. Default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The optuna study object containing the optimization results.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optuna.study.Study</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.rank_based_sampling">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.bcastor.</span></span><span class="sig-name descname"><span class="pre">rank_based_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.rank_based_sampling" title="Link to this definition">#</a></dt>
<dd><p>Sorts the trials based on their ECI values. Sample n_points according to the rank-based probabilities,
described in [1]. The argument alpha is the degree of prioritisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trials</strong> (<em>np.ndarray</em>) – Array of trial configurations.</p></li>
<li><p><strong>values</strong> (<em>np.ndarray</em>) – Array of values corresponding to the trial configurations.</p></li>
<li><p><strong>n_points</strong> (<em>int</em>) – Number of points to sample.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Exponent for the rank-based sampling probabilities. Default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of sampled trial configurations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.sort_and_get_n_maximum">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.bcastor.</span></span><span class="sig-name descname"><span class="pre">sort_and_get_n_maximum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.sort_and_get_n_maximum" title="Link to this definition">#</a></dt>
<dd><p>Sorts the trials based on their values in descending order and returns the top <cite>n_points</cite> trials.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trials</strong> (<em>np.ndarray</em>) – Array of trial configurations.</p></li>
<li><p><strong>values</strong> (<em>np.ndarray</em>) – Array of values corresponding to the trial configurations.</p></li>
<li><p><strong>n_points</strong> (<em>int</em>) – Number of top trials to return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of the top <cite>n_points</cite> trial configurations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.bcastor.study_to_array">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.bcastor.</span></span><span class="sig-name descname"><span class="pre">study_to_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">study</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#hepaid.search.policy.bcastor.study_to_array" title="Link to this definition">#</a></dt>
<dd><p>Converts the optuna study object to numpy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>study</strong> (<em>optuna.study.Study</em>) – The optuna study object containing the optimisation results.</p></li>
<li><p><strong>space_config</strong> (<em>dict</em>) – Configuration of the input space.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of trial configurations.
values (np.ndarray): Array of values corresponding to the trial configurations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trials (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-hepaid.search.policy.cas">
<span id="hepaid-search-policy-cas-module"></span><h2>hepaid.search.policy.cas module<a class="headerlink" href="#module-hepaid.search.policy.cas" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="hepaid.search.policy.cas.CAS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.cas.</span></span><span class="sig-name descname"><span class="pre">CAS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objective_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ObjectiveFunction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DictConfig</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.cas.CAS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hepaid.search.policy.base.Policy" title="hepaid.search.policy.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a></p>
<p>Constraint Active Search (CAS) [1], an alternative formulation for the multiobjective design problem as an
Active Search Problem,  objectives are treated as constraints with known desired threshold values;
the goal is to find diverse samples that satisfy all the thresholds. The thresholds define the satisfactory
region on the input space, denoted S. Expected Coverage Improvement (ECI), was developed for CAS. It places
hyper-spheres in the input data samples to measure diversity by aggregating the volume covered by each data point.
The optimal value of ECI corresponds to the sample in the input space that increases the volume covered of the S region
by the current dataset.</p>
<p>[1]: Beyond the Pareto Efficient Frontier: Constraint Active Search for Multiobjective
Experimental Design, G. Malkomes, B. Cheng, E.H. Lee, and M. McCourt</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>objective_function</strong> (<em>ObjectiveFunction</em>) – The ObjectiveFunction to perform the search.</p></li>
<li><p><strong>hyper_parameters</strong> (<em>DictConfig</em><em> | </em><em>str</em>) – Hyperparameters for the CAS strategy.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.cas.CAS.delta_r">
<span class="sig-name descname"><span class="pre">delta_r</span></span><a class="headerlink" href="#hepaid.search.policy.cas.CAS.delta_r" title="Link to this definition">#</a></dt>
<dd><p>Rate of change of the resolution parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.cas.CAS.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#hepaid.search.policy.cas.CAS.model" title="Link to this definition">#</a></dt>
<dd><p>The probabilistic surrogate model used in the CAS algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.cas.CAS.likelihood">
<span class="sig-name descname"><span class="pre">likelihood</span></span><a class="headerlink" href="#hepaid.search.policy.cas.CAS.likelihood" title="Link to this definition">#</a></dt>
<dd><p>The likelihood for the surrogate (GPs).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.cas.CAS.eci">
<span class="sig-name descname"><span class="pre">eci</span></span><a class="headerlink" href="#hepaid.search.policy.cas.CAS.eci" title="Link to this definition">#</a></dt>
<dd><p>Expected Coverage Improvement instance used in the CAS algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.cas.CAS.metrics">
<span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#hepaid.search.policy.cas.CAS.metrics" title="Link to this definition">#</a></dt>
<dd><p>Metrics instance to collect and log performance metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Metrics</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.cas.CAS.iteration">
<span class="sig-name descname"><span class="pre">iteration</span></span><a class="headerlink" href="#hepaid.search.policy.cas.CAS.iteration" title="Link to this definition">#</a></dt>
<dd><p>Current iteration number.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hepaid.search.policy.cas.CAS.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.cas.CAS.run" title="Link to this definition">#</a></dt>
<dd><p>Executes the CAS search algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The trained model after the search.
likelihood: The likelihood associated with the model.
eci: The Expected Coverage Improvement instance used.
study: The study object containing the search results.
metrics: The metrics collected during the search.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>model</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.cas.eci_step">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.cas.</span></span><span class="sig-name descname"><span class="pre">eci_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.cas.eci_step" title="Link to this definition">#</a></dt>
<dd><p>Expected Coverage Improvement (ECI) step. Fitting a GP for each objective.
Uses the original implementation of Expected Coverage Improvement.
Adapted from BoTorch implementation of CAS: <a class="reference external" href="https://botorch.org/tutorials/constraint_active_search">https://botorch.org/tutorials/constraint_active_search</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resolution</strong> (<em>float</em>) – The hyper-sphere radius for the ECI acquisition function.</p></li>
<li><p><strong>X</strong> (<em>np.ndarray</em>) – The input data points.</p></li>
<li><p><strong>Y</strong> (<em>np.ndarray</em>) – The outputs values corresponding to the input data points.</p></li>
<li><p><strong>constraints</strong> (<em>list</em>) – A list of constraints (given by obj_fn_export()).</p></li>
<li><p><strong>bounds</strong> (<em>np.ndarray</em>) – The bounds for the optimization variables (given by obj_fn_export()).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The next suggested input point by the ECI acquisition function.
model_list_gp (list): A list of Gaussian Process models fitted to each objective.
eci (ExpectedCoverageImprovement): The ECI acquisition function instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>x_next (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-hepaid.search.policy.eci">
<span id="hepaid-search-policy-eci-module"></span><h2>hepaid.search.policy.eci module<a class="headerlink" href="#module-hepaid.search.policy.eci" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.eci.</span></span><span class="sig-name descname"><span class="pre">ECI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">constraints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">punchout_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.eci.ECI" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Modified Implementation of Expected Coverage Improvement.
The surrogate model and the reference points are external.</p>
<p>Adapted from BoTorch implementation of CAS: <a class="reference external" href="https://botorch.org/tutorials/constraint_active_search">https://botorch.org/tutorials/constraint_active_search</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>constraints</strong> (<em>List</em><em>[</em><em>tuple</em><em>]</em>) – Each tuple contains a direction (“gt” or “lt”) and a threshold value.</p></li>
<li><p><strong>punchout_radius</strong> (<em>float</em>) – The radius of the hyper-spheres used for measuring coverage.</p></li>
<li><p><strong>bounds</strong> (<em>torch.Tensor</em>) – The bounds of the search space.</p></li>
<li><p><strong>train_x</strong> (<em>torch.Tensor</em>) – Training data inputs.</p></li>
<li><p><strong>train_y</strong> (<em>torch.Tensor</em>) – Training data outputs.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples for Monte Carlo integration. Default is 512.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI.constraints">
<span class="sig-name descname"><span class="pre">constraints</span></span><a class="headerlink" href="#hepaid.search.policy.eci.ECI.constraints" title="Link to this definition">#</a></dt>
<dd><p>Each tuple contains a direction (“gt” or “lt”) and a threshold value.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[tuple]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI.punchout_radius">
<span class="sig-name descname"><span class="pre">punchout_radius</span></span><a class="headerlink" href="#hepaid.search.policy.eci.ECI.punchout_radius" title="Link to this definition">#</a></dt>
<dd><p>The radius of the hyper-spheres used for measuring coverage.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><a class="headerlink" href="#hepaid.search.policy.eci.ECI.bounds" title="Link to this definition">#</a></dt>
<dd><p>The bounds of the search space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI.train_x">
<span class="sig-name descname"><span class="pre">train_x</span></span><a class="headerlink" href="#hepaid.search.policy.eci.ECI.train_x" title="Link to this definition">#</a></dt>
<dd><p>Training data inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI.train_y">
<span class="sig-name descname"><span class="pre">train_y</span></span><a class="headerlink" href="#hepaid.search.policy.eci.ECI.train_y" title="Link to this definition">#</a></dt>
<dd><p>Training data outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI.base_points">
<span class="sig-name descname"><span class="pre">base_points</span></span><a class="headerlink" href="#hepaid.search.policy.eci.ECI.base_points" title="Link to this definition">#</a></dt>
<dd><p>Base points in the training data (train_x).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI.train_inputs">
<span class="sig-name descname"><span class="pre">train_inputs</span></span><a class="headerlink" href="#hepaid.search.policy.eci.ECI.train_inputs" title="Link to this definition">#</a></dt>
<dd><p>Training data inputs (train_x).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI.ball_of_points">
<span class="sig-name descname"><span class="pre">ball_of_points</span></span><a class="headerlink" href="#hepaid.search.policy.eci.ECI.ball_of_points" title="Link to this definition">#</a></dt>
<dd><p>Points generated for Monte Carlo integration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI._thresholds">
<span class="sig-name descname"><span class="pre">_thresholds</span></span><a class="headerlink" href="#hepaid.search.policy.eci.ECI._thresholds" title="Link to this definition">#</a></dt>
<dd><p>Thresholds extracted from the constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI.dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#hepaid.search.policy.eci.ECI.dim" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.ECI.num_outputs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_outputs</span></span><a class="headerlink" href="#hepaid.search.policy.eci.ECI.num_outputs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.covar_dist">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.eci.</span></span><span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">square_dist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#hepaid.search.policy.eci.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the Euclidean distance between
all pairs of points in <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
<li><p><strong>square_dist</strong> – If True, returns the squared distance rather than the standard distance. (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.dist">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.eci.</span></span><span class="sig-name descname"><span class="pre">dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1_eq_x2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.eci.dist" title="Link to this definition">#</a></dt>
<dd><p>Equivalent to <cite>torch.cdist</cite> with p=2, but clamps the minimum element to 1e-15.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.smooth_box_mask">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.eci.</span></span><span class="sig-name descname"><span class="pre">smooth_box_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.002</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.eci.smooth_box_mask" title="Link to this definition">#</a></dt>
<dd><p>Returns 1ish for a &lt; x &lt; b and 0ish otherwise</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.smooth_mask">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.eci.</span></span><span class="sig-name descname"><span class="pre">smooth_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.002</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.eci.smooth_mask" title="Link to this definition">#</a></dt>
<dd><p>Returns 0ish for x &lt; a and 1ish for x &gt; a</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.eci.sq_dist">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.eci.</span></span><span class="sig-name descname"><span class="pre">sq_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1_eq_x2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.eci.sq_dist" title="Link to this definition">#</a></dt>
<dd><p>Equivalent to the square of <cite>torch.cdist</cite> with p=2.</p>
</dd></dl>

</section>
<section id="module-hepaid.search.policy.mcmc">
<span id="hepaid-search-policy-mcmc-module"></span><h2>hepaid.search.policy.mcmc module<a class="headerlink" href="#module-hepaid.search.policy.mcmc" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.MCMCMH">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.mcmc.</span></span><span class="sig-name descname"><span class="pre">MCMCMH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objective_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ObjectiveFunction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DictConfig</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.mcmc.MCMCMH" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#hepaid.search.policy.base.Policy" title="hepaid.search.policy.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></a></p>
<p>MCMC-MH (Markov Chain Monte Carlo - Metropolis-Hastings) sampling policy for search.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>objective_function</strong> (<em>ObjectiveFunction</em>) – The objective function instance.</p></li>
<li><p><strong>hyper_parameters</strong> (<em>DictConfig</em>) – Hyperparameters for the MCMC-MH algorithm.</p></li>
<li><p><strong>metrics</strong> (<em>Metrics</em>) – Metrics instance. Default is None.</p></li>
<li><p><strong>likelihood</strong> (<em>Callable</em>) – Custom likelihood function. Default is None.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.MCMCMH.idx_burnin">
<span class="sig-name descname"><span class="pre">idx_burnin</span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.MCMCMH.idx_burnin" title="Link to this definition">#</a></dt>
<dd><p>Number of iterations for the burn-in phase.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.MCMCMH.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.MCMCMH.scale" title="Link to this definition">#</a></dt>
<dd><p>Initial scale of the proposal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.MCMCMH.adapt_frequency">
<span class="sig-name descname"><span class="pre">adapt_frequency</span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.MCMCMH.adapt_frequency" title="Link to this definition">#</a></dt>
<dd><p>Frequency of adapting the proposal distribution scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.MCMCMH.likelihood">
<span class="sig-name descname"><span class="pre">likelihood</span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.MCMCMH.likelihood" title="Link to this definition">#</a></dt>
<dd><p>Likelihood function used in the MCMC-MH algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.MCMCMH.accepted">
<span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.MCMCMH.accepted" title="Link to this definition">#</a></dt>
<dd><p>Counter for accepted proposals.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.MCMCMH.curr_state">
<span class="sig-name descname"><span class="pre">curr_state</span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.MCMCMH.curr_state" title="Link to this definition">#</a></dt>
<dd><p>Current state in the parameter space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.MCMCMH.curr_likeli">
<span class="sig-name descname"><span class="pre">curr_likeli</span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.MCMCMH.curr_likeli" title="Link to this definition">#</a></dt>
<dd><p>Likelihood of the current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.MCMCMH.iteration">
<span class="sig-name descname"><span class="pre">iteration</span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.MCMCMH.iteration" title="Link to this definition">#</a></dt>
<dd><p>Current iteration number.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.MCMCMH.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.mcmc.MCMCMH.run" title="Link to this definition">#</a></dt>
<dd><p>Executes the MCMC-MH sampling algorithm.</p>
<p>The method initializes the state, performs the MCMC-MH sampling,
adapts the proposal distribution scale during the burn-in phase,
logs the progress, and saves checkpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the algorithm runs successfully.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.auto_likelihood">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.mcmc.</span></span><span class="sig-name descname"><span class="pre">auto_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objectives</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mult'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.auto_likelihood" title="Link to this definition">#</a></dt>
<dd><p>Automatically creates a likelihood value based on the objectives configuration,
applying sigmoid functions within specified boundaries. Supports two aggregation modes: sum and multiply.</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>result<span class="classifier">dict</span></dt><dd><p>A dictionary containing the results where keys are parameter names and values.</p>
</dd>
<dt>objectives<span class="classifier">dict</span></dt><dd><p>A dictionary containing the objectives configuration with two keys:</p>
</dd>
<dt>mode<span class="classifier">str, optional</span></dt><dd><p>The aggregation mode for likelihood calculation. Can be either ‘sum’ or ‘mult’. Default is ‘mult’.</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns:<a class="headerlink" href="#returns" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>float</dt><dd><p>The calculated likelihood value based on the given objectives and mode.</p>
</dd>
</dl>
</section>
<section id="raises">
<h3>Raises:<a class="headerlink" href="#raises" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>AssertionError</dt><dd><p>If the first condition in a double constraint is not ‘gt’.
If the first element in a single constraint is not a string.</p>
</dd>
</dl>
</section>
<section id="example">
<h3>Example:<a class="headerlink" href="#example" title="Link to this heading">#</a></h3>
<p>result = {‘param1’: 3, ‘param2’: 4}
objectives = {</p>
<blockquote>
<div><p>‘double_constraint’: {‘param1’: [[‘gt’, 2], [‘lt’, 4]]},
‘single_constraint’: {‘param2’: [‘lt’, 5]}</p>
</div></blockquote>
<p>}
likelihood = auto_likelihood(result, objectives, mode=’sum’)</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.mcmc_updater">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.mcmc.</span></span><span class="sig-name descname"><span class="pre">mcmc_updater</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curr_likeli</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal_distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.mcmc_updater" title="Link to this definition">#</a></dt>
<dd><p>MCMC-MH update. Generate a proposal state using the proposal distribution.
Ensure the proposal state is within bounds. Calculate the acceptance criterion.
Generate a random number between 0 and 1. If acceptance criterion is greater than
random number proposal is accepted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>curr_state</strong> (<em>np.ndarray</em>) – Current state in the parameter space.</p></li>
<li><p><strong>curr_likeli</strong> (<em>float</em>) – Likelihood of the current state.</p></li>
<li><p><strong>likelihood</strong> (<em>Callable</em>) – Function to compute the likelihood of a given state.</p></li>
<li><p><strong>proposal_distribution</strong> (<em>Callable</em>) – Function to generate a proposal state from the current state.</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – Scale parameter for the proposal distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the new state, its likelihood, and</dt><dd><p>a boolean indicating whether the proposal was accepted.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, float, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.proposal_distribution">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.mcmc.</span></span><span class="sig-name descname"><span class="pre">proposal_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.proposal_distribution" title="Link to this definition">#</a></dt>
<dd><p>Generates a  simple proposal state using a normal distribution centered on the
current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Current state in the parameter space.</p></li>
<li><p><strong>stepsize</strong> (<em>float</em>) – Step size or scale parameter for the proposal distribution.
Default is 0.5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Proposed state generated from the normal distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.sigmoid">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.mcmc.</span></span><span class="sig-name descname"><span class="pre">sigmoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.mcmc.sigmoid" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.smooth_box_mask">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.mcmc.</span></span><span class="sig-name descname"><span class="pre">smooth_box_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.002</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.mcmc.smooth_box_mask" title="Link to this definition">#</a></dt>
<dd><p>Returns 1ish for a &lt; x &lt; b and 0ish otherwise</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.smooth_mask">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.mcmc.</span></span><span class="sig-name descname"><span class="pre">smooth_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.002</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hepaid.search.policy.mcmc.smooth_mask" title="Link to this definition">#</a></dt>
<dd><p>Returns 0ish for x &lt; a and 1ish for x &gt; a</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hepaid.search.policy.mcmc.tune">
<span class="sig-prename descclassname"><span class="pre">hepaid.search.policy.mcmc.</span></span><span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_acceptance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.234</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hepaid.search.policy.mcmc.tune" title="Link to this definition">#</a></dt>
<dd><p>Adjusts the scale of the proposal distribution based on the acceptance rate.</p>
<p>This function is borrowed from PyMC3 and is used to adapt the scale to achieve a
target acceptance rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scale</strong> (<em>float</em>) – Current scale of the proposal distribution.</p></li>
<li><p><strong>acceptance</strong> (<em>float</em>) – Current acceptance rate of the proposals.</p></li>
<li><p><strong>target_acceptance</strong> (<em>float</em>) – Target acceptance rate. Default is 0.234.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Adjusted scale for the proposal distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-hepaid.search.policy">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-hepaid.search.policy" title="Link to this heading">#</a></h2>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="hepaid.search.parallel.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">hepaid.search.parallel package</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-hepaid.search.policy.base">hepaid.search.policy.base module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.base.Policy"><code class="docutils literal notranslate"><span class="pre">Policy</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.base.Policy.objective_function"><code class="docutils literal notranslate"><span class="pre">Policy.objective_function</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.base.Policy.hp"><code class="docutils literal notranslate"><span class="pre">Policy.hp</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.base.Policy.hp_name"><code class="docutils literal notranslate"><span class="pre">Policy.hp_name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.base.Policy.metrics"><code class="docutils literal notranslate"><span class="pre">Policy.metrics</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.base.Policy.save_path"><code class="docutils literal notranslate"><span class="pre">Policy.save_path</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.base.Policy.iteration"><code class="docutils literal notranslate"><span class="pre">Policy.iteration</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.base.Policy.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">Policy.load_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id0"><code class="docutils literal notranslate"><span class="pre">Policy.load_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.base.Policy.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">Policy.save_checkpoint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-hepaid.search.policy.bcastor">hepaid.search.policy.bcastor module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.bCASTOR"><code class="docutils literal notranslate"><span class="pre">bCASTOR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.bCASTOR.delta_r"><code class="docutils literal notranslate"><span class="pre">bCASTOR.delta_r</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.bCASTOR.model"><code class="docutils literal notranslate"><span class="pre">bCASTOR.model</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.bCASTOR.likelihood"><code class="docutils literal notranslate"><span class="pre">bCASTOR.likelihood</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.bCASTOR.eci"><code class="docutils literal notranslate"><span class="pre">bCASTOR.eci</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.bCASTOR.study"><code class="docutils literal notranslate"><span class="pre">bCASTOR.study</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.bCASTOR.metrics"><code class="docutils literal notranslate"><span class="pre">bCASTOR.metrics</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.bCASTOR.iteration"><code class="docutils literal notranslate"><span class="pre">bCASTOR.iteration</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.bCASTOR.run"><code class="docutils literal notranslate"><span class="pre">bCASTOR.run()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.bcastor_step"><code class="docutils literal notranslate"><span class="pre">bcastor_step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.create_optuna_objective"><code class="docutils literal notranslate"><span class="pre">create_optuna_objective()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.optuna_study_cmaes"><code class="docutils literal notranslate"><span class="pre">optuna_study_cmaes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.optuna_study_nsgaii"><code class="docutils literal notranslate"><span class="pre">optuna_study_nsgaii()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.optuna_study_tpe"><code class="docutils literal notranslate"><span class="pre">optuna_study_tpe()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.rank_based_sampling"><code class="docutils literal notranslate"><span class="pre">rank_based_sampling()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.sort_and_get_n_maximum"><code class="docutils literal notranslate"><span class="pre">sort_and_get_n_maximum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.bcastor.study_to_array"><code class="docutils literal notranslate"><span class="pre">study_to_array()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-hepaid.search.policy.cas">hepaid.search.policy.cas module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.cas.CAS"><code class="docutils literal notranslate"><span class="pre">CAS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.cas.CAS.delta_r"><code class="docutils literal notranslate"><span class="pre">CAS.delta_r</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.cas.CAS.model"><code class="docutils literal notranslate"><span class="pre">CAS.model</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.cas.CAS.likelihood"><code class="docutils literal notranslate"><span class="pre">CAS.likelihood</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.cas.CAS.eci"><code class="docutils literal notranslate"><span class="pre">CAS.eci</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.cas.CAS.metrics"><code class="docutils literal notranslate"><span class="pre">CAS.metrics</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.cas.CAS.iteration"><code class="docutils literal notranslate"><span class="pre">CAS.iteration</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.cas.CAS.run"><code class="docutils literal notranslate"><span class="pre">CAS.run()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.cas.eci_step"><code class="docutils literal notranslate"><span class="pre">eci_step()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-hepaid.search.policy.eci">hepaid.search.policy.eci module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI"><code class="docutils literal notranslate"><span class="pre">ECI</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI.constraints"><code class="docutils literal notranslate"><span class="pre">ECI.constraints</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI.punchout_radius"><code class="docutils literal notranslate"><span class="pre">ECI.punchout_radius</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI.bounds"><code class="docutils literal notranslate"><span class="pre">ECI.bounds</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI.train_x"><code class="docutils literal notranslate"><span class="pre">ECI.train_x</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI.train_y"><code class="docutils literal notranslate"><span class="pre">ECI.train_y</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI.base_points"><code class="docutils literal notranslate"><span class="pre">ECI.base_points</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI.train_inputs"><code class="docutils literal notranslate"><span class="pre">ECI.train_inputs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI.ball_of_points"><code class="docutils literal notranslate"><span class="pre">ECI.ball_of_points</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI._thresholds"><code class="docutils literal notranslate"><span class="pre">ECI._thresholds</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI.dim"><code class="docutils literal notranslate"><span class="pre">ECI.dim</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.ECI.num_outputs"><code class="docutils literal notranslate"><span class="pre">ECI.num_outputs</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.covar_dist"><code class="docutils literal notranslate"><span class="pre">covar_dist()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.dist"><code class="docutils literal notranslate"><span class="pre">dist()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.smooth_box_mask"><code class="docutils literal notranslate"><span class="pre">smooth_box_mask()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.smooth_mask"><code class="docutils literal notranslate"><span class="pre">smooth_mask()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.eci.sq_dist"><code class="docutils literal notranslate"><span class="pre">sq_dist()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-hepaid.search.policy.mcmc">hepaid.search.policy.mcmc module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.MCMCMH"><code class="docutils literal notranslate"><span class="pre">MCMCMH</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.MCMCMH.idx_burnin"><code class="docutils literal notranslate"><span class="pre">MCMCMH.idx_burnin</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.MCMCMH.scale"><code class="docutils literal notranslate"><span class="pre">MCMCMH.scale</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.MCMCMH.adapt_frequency"><code class="docutils literal notranslate"><span class="pre">MCMCMH.adapt_frequency</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.MCMCMH.likelihood"><code class="docutils literal notranslate"><span class="pre">MCMCMH.likelihood</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.MCMCMH.accepted"><code class="docutils literal notranslate"><span class="pre">MCMCMH.accepted</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.MCMCMH.curr_state"><code class="docutils literal notranslate"><span class="pre">MCMCMH.curr_state</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.MCMCMH.curr_likeli"><code class="docutils literal notranslate"><span class="pre">MCMCMH.curr_likeli</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.MCMCMH.iteration"><code class="docutils literal notranslate"><span class="pre">MCMCMH.iteration</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.MCMCMH.run"><code class="docutils literal notranslate"><span class="pre">MCMCMH.run()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.auto_likelihood"><code class="docutils literal notranslate"><span class="pre">auto_likelihood()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.mcmc_updater"><code class="docutils literal notranslate"><span class="pre">mcmc_updater()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.proposal_distribution"><code class="docutils literal notranslate"><span class="pre">proposal_distribution()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.sigmoid"><code class="docutils literal notranslate"><span class="pre">sigmoid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.smooth_box_mask"><code class="docutils literal notranslate"><span class="pre">smooth_box_mask()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.smooth_mask"><code class="docutils literal notranslate"><span class="pre">smooth_mask()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hepaid.search.policy.mcmc.tune"><code class="docutils literal notranslate"><span class="pre">tune()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-hepaid.search.policy">Module contents</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/hepaid.search.policy.rst">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>